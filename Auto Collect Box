-- Chức năng Auto Teleport và Click với Tween
local TweenService = game:GetService("TweenService")
local autoActive = true  -- Thêm biến autoActive để tránh lỗi

local function autoTeleportAndClick()
    local boxes = {}
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("MeshPart") and obj.Name == "Box" then
            table.insert(boxes, obj)
        end
    end

    if #boxes == 0 then
        warn("No 'Box' MeshParts found in Workspace.")
        return
    end

    local currentIndex = 1
    local holdDuration = 2

    local function holdClickOrActivate(part)
        local clickDetector = part:FindFirstChildOfClass("ClickDetector")
        if clickDetector then
            local startTime = tick()
            while tick() - startTime < holdDuration and autoActive do
                fireclickdetector(clickDetector)
                wait(0.1)
            end
        end

        local proximityPrompt = part:FindFirstChildOfClass("ProximityPrompt")
        if proximityPrompt then
            local startTime = tick()
            while tick() - startTime < holdDuration and autoActive do
                fireproximityprompt(proximityPrompt, Enum.ProximityPromptInputType.Keyboard)
                wait(0.1)
            end
        end
    end

    while autoActive do
        local currentBox = boxes[currentIndex]
        local player = game.Players.LocalPlayer
        if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local humanoidRootPart = player.Character.HumanoidRootPart
            
            -- Tạo tween cho việc di chuyển
            local goal = {}
            goal.CFrame = currentBox.CFrame + Vector3.new(0, 3, 0)
            local tweenInfo = TweenInfo.new(3, Enum.EasingStyle.Linear, Enum.EasingDirection.Out)
            local tween = TweenService:Create(humanoidRootPart, tweenInfo, goal)
            tween:Play()
            tween.Completed:Wait()
        else
            warn("Character or HumanoidRootPart not found. Skipping teleport.")
        end

        holdClickOrActivate(currentBox)
        currentIndex = (currentIndex % #boxes) + 1
        wait(2)
    end
end
